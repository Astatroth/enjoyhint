"use strict";!function(a){"function"==typeof define&&define.amd?define(["jquery","./jquery.enjoyhint.js","jquery.scrollto"],a):"function"==typeof require&&"object"==typeof exports?module.exports=a(require("jquery"),require("./jquery.enjoyhint.js"),require("jquery.scrollto")):window.EnjoyHint=a(jQuery)}(function(a){return function(b){function c(){o.enjoyhint("render_circle",[]),a("#enjoyhint_label").remove(),a("#enjoyhint_arrpw_line").remove(),o.enjoyhint("hide_next"),o.enjoyhint("hide_skip")}var d,e=this,f=b||{},g=f.btnNextText||"Next",h=f.btnSkipText||"Skip",i=f.backgroundColor||"rgba(0,0,0,0.6)",j="body",k={onStart:function(){},onEnd:function(){},onSkip:function(){},onNext:function(){}},l=a.extend(k,f),m=[],n=0,o=a(j),p=function(){a(".enjoyhint")&&a(".enjoyhint").remove(),o.css({overflow:"hidden"}),a(document).on("touchmove",q),o.enjoyhint({onNextClick:function(){t()},onSkipClick:function(){l.onSkip(),u()},fill:i})},q=function(a){a.preventDefault()},r=function(){a(".enjoyhint").remove(),o.css({overflow:"auto"}),a(document).off("touchmove",q)};e.clear=function(){var b=a(".enjoyhint_next_btn"),c=a(".enjoyhint_skip_btn");b.removeClass(e.nextUserClass),b.text(g),c.removeClass(e.skipUserClass),c.text(h)};var s=function(){if(!m||!m[n])return o.enjoyhint("hide"),l.onEnd(),void r();l.onNext();var b=a(".enjoyhint");b.removeClass("enjoyhint-step-"+n),b.removeClass("enjoyhint-step-"+(n+1)),b.addClass("enjoyhint-step-"+(n+1));var f=m[n];f.onBeforeStart&&"function"==typeof f.onBeforeStart&&f.onBeforeStart();var g=f.timeout||0;setTimeout(function(){if(!f.selector)for(var b in f)f.hasOwnProperty(b)&&b.split(" ")[1]&&(f.selector=b.split(" ")[1],f.event=b.split(" ")[0],"next"!=b.split(" ")[0]&&"auto"!=b.split(" ")[0]&&"custom"!=b.split(" ")[0]||(f.event_type=b.split(" ")[0]),f.description=f[b]);setTimeout(function(){e.clear()},250);var g=a(f.selector).get(0).getBoundingClientRect();(g.top<0||g.bottom>(window.innerHeight||document.documentElement.clientHeight))&&(c(),a(document.body).scrollTo(f.selector,f.scrollAnimationSpeed||250,{offset:-200})),setTimeout(function(){var b=a(f.selector),c=v(f.event);if(o.enjoyhint("show"),o.enjoyhint("hide_next"),d=b,f.event_selector&&(d=a(f.event_selector)),f.event_type||"key"!=f.event||b.keydown(function(a){a.which==f.keyCode&&(n++,s())}),1==f.showNext&&o.enjoyhint("show_next"),0==f.showSkip?o.enjoyhint("hide_skip"):o.enjoyhint("show_skip"),f.showSkip,f.nextButton){var g=a(".enjoyhint_next_btn");g.addClass(f.nextButton.className||""),g.text(f.nextButton.text||"Next"),e.nextUserClass=f.nextButton.className}if(f.skipButton){var h=a(".enjoyhint_skip_btn");h.addClass(f.skipButton.className||""),h.text(f.skipButton.text||"Skip"),e.skipUserClass=f.skipButton.className}if(f.event_type)switch(f.event_type){case"auto":return b[f.event](),f.event,n++,void s();case"custom":w(f.event,function(){n++,x(f.event),s()});break;case"next":o.enjoyhint("show_next")}else d.on(c,function(b){f.keyCode&&b.keyCode!=f.keyCode||(n++,a(this).off(c),s())});var i=Math.max(b.outerWidth(),b.outerHeight()),j=f.radius||Math.round(i/2)+5,k=b.offset(),l=b.outerWidth(),m=b.outerHeight(),p=void 0!==f.margin?f.margin:10,q={x:k.left+Math.round(l/2),y:k.top+Math.round(m/2)-a(document).scrollTop()},r={enjoyHintElementSelector:f.selector,center_x:q.x,center_y:q.y,text:f.description,top:f.top,bottom:f.bottom,left:f.left,right:f.right,margin:f.margin,scroll:f.scroll};f.shape&&"circle"==f.shape?(r.shape="circle",r.radius=j):(r.radius=0,r.width=l+p,r.height=m+p),o.enjoyhint("render_label_with_shape",r,e.stop)},f.scrollAnimationSpeed+20||270)},g)},t=function(){n++,s()},u=function(){var b=m[n],c=a(b.selector);x(b.event),c.off(v(b.event)),r()},v=function(a,b){return a+(b?"custom":"")+".enjoy_hint"},w=function(a,b){o.on(v(a,!0),b)},x=function(a){o.off(v(a,!0))};window.addEventListener("resize",function(){null!=d&&o.enjoyhint("redo_events_near_rect",d[0].getBoundingClientRect())},!1),e.stop=function(){u()},e.reRunScript=function(a){n=a,s()},e.runScript=function(){n=0,l.onStart(),s()},e.resumeScript=function(){s()},e.setCurrentStep=function(a){n=a},e.getCurrentStep=function(){return n},e.trigger=function(a){switch(a){case"next":t();break;case"skip":u()}},e.setScript=function(a){if(!(a instanceof Array)&&a.length<1)throw new Error("Configurations list isn't correct.");m=a},e.set=function(a){e.setScript(a)},e.setSteps=function(a){e.setScript(a)},e.run=function(){e.runScript()},e.resume=function(){e.resumeScript()},p()}});